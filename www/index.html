<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tasklist AMS2</title>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.14.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="https://code.jquery.com/ui/1.14.1/jquery-ui.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 16px;
        }
        .tasca {
            margin: 8px;
            padding: 8px;
            border: 2px solid black;
            border-radius: 8px;
            width: fit-content;
        }
        button {
            font-size: 16px;
            border-width: 4px;
            border-radius: 4px;
            cursor: pointer;
        }
        .elimina {
            background-color: red;
            border-color: maroon;
        }
        .edita {
            background-color: yellow;
            border-color: darkgoldenrod;
        }
        .afegeix {
            margin-top: 8px;
            padding: 4px 8px;
            background-color: rgb(0, 153, 0);
            border-color: darkgreen;
            color: white;
        }
        .elimina, .edita {
            margin-left: 16px;
            padding: 2px 4px;
            color: black;
        }
        #dialog{
            display: none;
        }
        #cap_tasca {
            font-style: italic;
            color: gray;
        }
    </style>
</head>
<body>
    <h1>Tasklist</h1>
    
    <!-- Missatge quan no hi ha tasques -->
    <span id="cap_tasca">(Cap tasca a la llista.)</span>
    
    <div id="list">
    </div>
    <hr>
    <div id="dialog">
        Nom de la tasca:
        <input type="text"/>
    </div>
    <button class="afegeix" onClick="afegeix()">Afegeix</button>
    <script>
        function afegeix() {
            $("#dialog").dialog({
                resizable: false,
                height: "auto",
                width: 400,
                modal: true,
                buttons: {
                    "Afegir tasca": function() {
                        const taskname = $('input').val();
                        
                        const elem = $(
                            '<div class="tasca">' + 
                                '<span class="nom">'+taskname+'</span>' +
                                '<button class="edita">Edita</button>' +
                                '<button class="elimina">&times;</button>' +
                            '</div>');
                        $(".edita", elem).click(edita);
                        $(".elimina", elem).click(elimina);
                        $('#list').append(elem);
                        
                        $('input').val("");
                        $(this).dialog("close");

                        // Amaga el missatge de cap tasca
                        if ($('#cap_tasca').is(':visible')) {
                            $('#cap_tasca').hide();
                        }
                    },
                    Cancel: function() {
                    $('input').val("");
                    $(this).dialog("close");
                    }
                }
            });  
        }
        function elimina(event) {
            var caller = event.target || event.srcElement;
            $(caller).parent().remove();
            
            // Mostra el missatge de cap tasca si la llista est√† buida
            if ($('#list').children().length === 0) {
                $('#cap_tasca').show();
            }
        }
        function edita(event) {
            var caller = event.target || event.srcElement;
            $("#dialog").dialog({
                resizable: false,
                height: "auto",
                width: 400,
                modal: true,
                buttons: {
                    "Editar tasca": function() {
                        const taskname = $('input').val();
                        
                        $(caller).parent().find('.nom').text(taskname);

                        $('input').val("");
                        $(this).dialog("close");
                    },
                    Cancel: function() {
                    $('input').val("");
                    $(this).dialog("close");
                    }
                }
            });
        }
    </script>
</body>
</html>